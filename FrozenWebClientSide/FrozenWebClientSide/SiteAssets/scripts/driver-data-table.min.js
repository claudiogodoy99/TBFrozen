!function(M){M(function(){var n,o="http://localhost:64523/",r=M("#loading-modal"),d=M("#addModal"),t=M("#deleteModal"),e=M("#delete-driver-form"),i=M("#editModal"),a=M("#edit-driver-form"),l=M("#add-driver-form"),c=M('#add-driver-form [name="driver-name"]'),m=M('#add-driver-form [name="driver-cnh"]'),s=M('#add-driver-form [name="driver-company-cnpj"]'),f=M('#edit-driver-form [name="driver-name"]'),u=M('#edit-driver-form [name="driver-cnh"]'),p=M('#edit-driver-form [name="driver-company-cnpj"]'),v=JSON.parse(localStorage.getItem("currentUser"));function h(e,a){void 0===a&&(a=!0),a?(M(e).removeClass("d-none"),setTimeout(function(){M(e).addClass("d-none")},5e3)):M(e).addClass("d-none")}function g(e){e.forEach(function(e){M(e).val(null)})}function y(){var a=M.Deferred(),e={url:o+"api/Motorista/ListarTodosDaEmpresa/"+v.empresaCnpj,type:"GET",contentType:"application/json; charset=utf-8"};return M.ajax(e).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}),a.promise()}function j(e){M("#driver-table tbody").html(""),M("#data-results").text(e.length),0<e.length&&e.forEach(function(e){M("#driver-table tbody").append('\n            <tr data-item="'+e.cnh+'">\n              <td style="min-width: 150px;">'+e.nome+"</td>\n              <td>"+e.cnh+'</td>\n              <td style="min-width: 150px;">'+s.masked(e.empresaCnpj)+'</td>\n              <td>\n                <a href="#editModal" class="edit" onclick="setItemToDeleteOrUpdateValue('+e.cnh+')" data-toggle="modal"><i class="fa fa-pencil" aria-hidden="true" data-toggle="tooltip" title="Editar"></i></a>\n                <a href="#deleteModal" class="delete" onclick="setItemToDeleteOrUpdateValue('+e.cnh+')" data-toggle="modal"><i class="fa fa-trash" aria-hidden="true" data-toggle="tooltip" title="Excluir"></i></a>\n              </td>\n            </tr>')})}s.mask("00.000.000/0000-00",{reverse:!0}),p.mask("00.000.000/0000-00",{reverse:!0}),r.modal(),y().done(function(e){j(e),r.modal("hide")}).fail(function(e){r.modal("hide"),h("#error-alert"),console.log(e)}),l.on("submit",function(e){e.preventDefault(),d.modal("hide"),r.modal();var a={};a.nome=c.val(),a.cnh=m.val(),a.empresaCnpj=s.cleanVal();var t={url:o+"api/Motorista/Cadastrar",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(a)};M.ajax(t).done(function(e){y().done(function(e){j(e),g(['#addModal [name="driver-name"]','#addModal [name="driver-cnh"]','#addModal [name="driver-company-cnpj"]']),r.modal("hide"),h("#success-alert")}).fail(function(e){r.modal("hide"),h("#error-alert"),console.log(e)})}).fail(function(e){r.modal("hide"),h("#error-alert"),console.error(e)})}),e.on("submit",function(e){e.preventDefault(),t.modal("hide"),r.modal();var a={url:o+"api/Motorista/Deletar/"+n.toString(),contentType:"application/json; charset=utf-8",type:"DELETE"};M.ajax(a).done(function(e){y().done(function(e){j(e),r.modal("hide"),h("#success-alert")}).fail(function(e){r.modal("hide"),h("#error-alert"),console.log(e)})}).fail(function(e){r.modal("hide"),h("#error-alert"),console.error(e)})}),a.on("submit",function(e){e.preventDefault(),i.modal("hide"),r.modal();var a={};a.cnh=n,a.nome=f.val(),a.empresaCnpj=p.cleanVal();var t={url:o+"api/Motorista/Atualizar",contentType:"application/json; charset=utf-8",type:"PUT",data:JSON.stringify(a)};M.ajax(t).done(function(e){y().done(function(e){j(e),g(['#editModal [name="driver-name"]','#editModal [name="driver-cnh"]','#editModal [name="driver-company-cnpj"]']),r.modal("hide"),h("#success-alert")}).fail(function(e){r.modal("hide"),h("#error-alert"),console.log(e)})}).fail(function(e){r.modal("hide"),h("#error-alert"),console.error(e)})}),window.setItemToDeleteOrUpdateValue=function(e){var a=M('[data-item="'+(n=e)+'"]').find("td");f.val(M(a[0]).text()),u.val(M(a[1]).text()),p.val(p.masked(M(a[2]).text()))}})}(jQuery);