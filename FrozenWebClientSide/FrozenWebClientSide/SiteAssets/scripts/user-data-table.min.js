!function(E){E(function(){var n,o="http://localhost:64523/",d=E("#loading-modal"),r=E("#addModal"),t=E("#deleteModal"),e=E("#delete-user-form"),l=E("#editModal"),a=E("#edit-user-form"),s=E("#add-user-form"),i=E('#add-user-form [name="user-name"]'),m=E('#add-user-form [name="user-password"]'),u=E('#add-user-form [name="user-email"]'),c=E('#add-user-form [name="user-company-cnpj"]'),f=E('#add-user-form [name="user-address"]'),p=E('#add-user-form [name="user-phone"]'),h=E('#edit-user-form [name="user-name"]'),v=E('#edit-user-form [name="user-password"]'),y=E('#edit-user-form [name="user-email"]'),g=E('#edit-user-form [name="user-company-cnpj"]'),j=E('#edit-user-form [name="user-address"]'),x=E('#edit-user-form [name="user-phone"]'),M=JSON.parse(localStorage.getItem("currentUser"));function T(e,a){void 0===a&&(a=!0),a?(E(e).removeClass("d-none"),setTimeout(function(){E(e).addClass("d-none")},5e3)):E(e).addClass("d-none")}function w(e){e.forEach(function(e){E(e).val(null)})}function k(){var a=E.Deferred(),e={url:o+"api/Usuario/ListarTodosDaEmpresa/"+M.empresaCnpj,type:"GET",contentType:"application/json; charset=utf-8"};return E.ajax(e).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}),a.promise()}function D(e){E("#user-table tbody").html(""),E("#data-results").text(e.length),0<e.length&&e.forEach(function(e){E("#user-table tbody").append('\n            <tr data-item="'+e.id+'">\n              <td class="d-none">'+e.id+'</td>\n              <td class="d-none">'+e.senha+'</td>\n              <td style="min-width: 150px;">'+e.nome+'</td>\n              <td style="min-width: 100px;">'+e.email+'</td>\n              <td style="min-width: 150px;">'+e.endereco+'</td>\n              <td style="min-width: 100px;">'+p.masked(e.telefone)+'</td>\n              <td style="min-width: 100px;">'+c.masked(e.empresaCnpj)+'</td>\n              <td>\n                <a href="#editModal" class="edit" onclick="setItemToDeleteOrUpdateValue('+e.id+')" data-toggle="modal"><i class="fa fa-pencil" aria-hidden="true" data-toggle="tooltip" title="Editar"></i></a>\n                <a href="#deleteModal" class="delete" onclick="setItemToDeleteOrUpdateValue('+e.id+')" data-toggle="modal"><i class="fa fa-trash" aria-hidden="true" data-toggle="tooltip" title="Excluir"></i></a>\n              </td>\n            </tr>')})}c.mask("00.000.000/0000-00",{reverse:!0}),p.mask("(00) 00000-0000"),g.mask("00.000.000/0000-00",{reverse:!0}),x.mask("(00) 00000-0000"),d.modal(),k().done(function(e){D(e),d.modal("hide")}).fail(function(e){d.modal("hide"),T("#error-alert"),console.log(e)}),s.on("submit",function(e){e.preventDefault(),r.modal("hide"),d.modal();var a={};a.nome=i.val(),a.email=u.val(),a.senha=m.val(),a.empresaCnpj=c.cleanVal(),a.endereco=f.val(),a.telefone=p.cleanVal();var t={url:o+"api/Usuario/Cadastrar",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(a)};E.ajax(t).done(function(e){k().done(function(e){D(e),w(['#addModal [name="user-name"]','#addModal [name="user-email"]','#addModal [name="user-password"]','#addModal [name="user-company-cnpj"]','#addModal [name="user-phone"]','#addModal [name="user-address"]']),d.modal("hide"),T("#success-alert")}).fail(function(e){d.modal("hide"),T("#error-alert"),console.log(e)})}).fail(function(e){d.modal("hide"),T("#error-alert"),console.error(e)})}),e.on("submit",function(e){e.preventDefault(),t.modal("hide"),d.modal();var a={url:o+"api/Usuario/Deletar/"+n.toString(),contentType:"application/json; charset=utf-8",type:"DELETE"};E.ajax(a).done(function(e){k().done(function(e){D(e),d.modal("hide"),T("#success-alert")}).fail(function(e){d.modal("hide"),T("#error-alert"),console.log(e)})}).fail(function(e){d.modal("hide"),T("#error-alert"),console.error(e)})}),a.on("submit",function(e){e.preventDefault(),l.modal("hide"),d.modal();var a={};a.id=n,a.nome=h.val(),a.email=y.val(),a.senha=v.val(),a.empresaCnpj=g.cleanVal(),a.endereco=j.val(),a.telefone=x.cleanVal();var t={url:o+"api/Usuario/Atualizar",contentType:"application/json; charset=utf-8",type:"PUT",data:JSON.stringify(a)};E.ajax(t).done(function(e){k().done(function(e){D(e),w(['#editModal [name="user-name"]','#editModal [name="user-email"]','#editModal [name="user-password"]','#editModal [name="user-company-cnpj"]','#editModal [name="user-phone"]','#editModal [name="user-address"]']),d.modal("hide"),T("#success-alert")}).fail(function(e){d.modal("hide"),T("#error-alert"),console.log(e)})}).fail(function(e){d.modal("hide"),T("#error-alert"),console.error(e)})}),window.setItemToDeleteOrUpdateValue=function(e){var a=E('[data-item="'+(n=e)+'"]').find("td");v.val(E(a[1]).text()),h.val(E(a[2]).text()),y.val(E(a[3]).text()),j.val(E(a[4]).text()),x.val(x.masked(E(a[5]).text())),g.val(g.masked(E(a[6]).text()))}})}(jQuery);